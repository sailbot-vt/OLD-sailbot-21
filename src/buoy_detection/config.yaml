# buoy_detection config.yaml file

# For properties that are useful in multiple parts of the buoy_detection module.
common:
  # The distance between the cameras (the "baseline"), in meters.
  baseline: 0.2

calibration:

  chessboard_specs:
    # The real size of each chessboard square, in meters.
    square_size: .024

    # The shape of the grid of internal chessboard squares as a 2-tuple of the form (x_size, y_size)
    grid_shape: !!python/tuple [6, 9]


  finding_corners:
    # Affects how OpenCV2 locates internal chessboard corners.
    corner_flags: "cv2.CALIB_CB_NORMALIZE_IMAGE | cv2.CALIB_CB_FAST_CHECK | cv2.CALIB_CB_ADAPTIVE_THRESH"

    # Corner Sub-Pixel (CSP) Refinement Parameters
    csp_window_size: !!python/tuple [11, 11]
    csp_zero_zone: !!python/tuple [-1, -1]


  # Controls the stopping behavior of various iterative OpenCV2 processes, such as corner sub-pixel
  # refinement.
  term_criteria:
    term_flags: "cv2.TERM_CRITERIA_EPS | cv2.TERM_CRITERIA_MAX_ITER"
    max_iterations: 30
    min_accuracy: 0.001


  # Scaling parameter for image rectification.
  # https://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html
  # See stereoRectify(), "alpha" parameter.
  rectification_alpha: 0.25

  # Draw images with chessboard overlay as we analyze them? Can cause performance slowdowns.
  draw_image: True

  # Delete pairs of images that contain an invalid image?
  # "Invalid images" are any images that OpenCV2 cannot find a (complete) set of chessboard corners for.
  delete_unreadable_images: False

  # Must contain LEFT and RIGHT subdirectories, each with corresponding images.
  base_path: "~/test/directory/images/"

  # The name of the stereo calibration matrix output file.
  calibration_export_filename: "stereo_calibration.npz"

  # The name of the projection / rectification matrix output file.
  projection_export_filename: "projection_matrices.npz"


depth_map:

  # The name of the stereo calibration matrix file to use.
  calibration_filename: "stereo_calibration.npz"

  # The field of view, in degrees.
  fov: 56

  # The numbers of the USB ports each camera is plugged into.
  camera_numbers: !!python/tuple [2, 3]

  # Whether or not to draw the depth map as it is calculated. Can cause performance slowdowns.
  draw_image: False

  # Options for setting up the Stereo Block Matching algorithm to find corresponding image points in the stereo images.
  # For details on each individual parameter, see:
  # https://docs.opencv.org/2.4/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html?highlight=sgbm.
  stereo_bm:
    min_disparity: 0
    num_disparities: 160
    block_size: 5
    uniqueness_ratio: 15
    speckle_window_size: 0
    speckle_range: 2
    remap_interpolation: "cv2.INTER_LINEAR"
    depth_visualization_scale: 32